{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\filip\\\\instagram-clone\\\\instagram-clone\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\filip\\\\instagram-clone\\\\instagram-clone\\\\src\\\\ImageUpload.js\";\nimport { Button } from '@mui/material';\nimport React, { useState } from 'react';\nimport { db, storage } from './firebase';\nimport firebase from 'firebase/compat/app';\n\nfunction ImageUpload(_ref) {\n  var username = _ref.username;\n\n  var _useState = useState(''),\n      _useState2 = _slicedToArray(_useState, 2),\n      caption = _useState2[0],\n      setCaption = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      progress = _useState4[0],\n      setProgress = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      image = _useState6[0],\n      setImage = _useState6[1];\n\n  var handleChange = function handleChange(e) {\n    if (e.target.files[0]) {\n      setImage(e.target.files[0]);\n    }\n  };\n\n  var handleUpload = function handleUpload() {\n    var uploadTask = storage.ref(\"images/\".concat(image.name)).put(image);\n    uploadTask.on(\"state_changed\", function (snapshot) {\n      var progress = Math.round(snapshot.bytesTransferred / snapshot.totalBytes * 100);\n      setProgress(progress);\n    }, function (error) {\n      console.log(error);\n      alert(error.message);\n    }, function () {\n      storage.ref(\"images\").child(image.name).getDownloadURL().then(function (url) {\n        db.collection(\"posts\").add({\n          timestamp: firebase.firestore.FieldValue.serverTimestamp(),\n          caption: caption,\n          imageUrl: url,\n          username: username\n        });\n        setProgress(0);\n        setCaption(\"\");\n        setImage(null);\n      });\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"imageUpload\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"progress\", {\n    value: progress,\n    max: \"100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    placeholder: \"Enter a caption..\",\n    onChange: function onChange(event) {\n      return setCaption(event.target.value);\n    },\n    value: caption,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    type: \"file\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    onClick: handleUpload,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }\n  }, \"Upload\"));\n}\n\nexport default ImageUpload;","map":{"version":3,"names":["Button","React","useState","db","storage","firebase","ImageUpload","username","caption","setCaption","progress","setProgress","image","setImage","handleChange","e","target","files","handleUpload","uploadTask","ref","name","put","on","snapshot","Math","round","bytesTransferred","totalBytes","error","console","log","alert","message","child","getDownloadURL","then","url","collection","add","timestamp","firestore","FieldValue","serverTimestamp","imageUrl","event","value"],"sources":["C:/Users/filip/instagram-clone/instagram-clone/src/ImageUpload.js"],"sourcesContent":["import { Button } from '@mui/material'\r\nimport React, { useState } from 'react'\r\nimport { db, storage } from './firebase';\r\nimport firebase from 'firebase/compat/app';\r\n\r\nfunction ImageUpload({ username }) {\r\n    const [caption, setCaption] = useState('');\r\n    const [progress, setProgress] = useState(0);\r\n    const [image, setImage] = useState(null);\r\n\r\n    const handleChange = (e) => {\r\n        if (e.target.files[0]) {\r\n            setImage(e.target.files[0]);\r\n        }\r\n    };\r\n\r\n    const handleUpload = () => {\r\n        const uploadTask = storage.ref(`images/${image.name}`).put(image);\r\n        uploadTask.on(\r\n            \"state_changed\",\r\n            (snapshot) => {\r\n                const progress = Math.round(\r\n                    (snapshot.bytesTransferred / snapshot.totalBytes * 100)\r\n                );\r\n                setProgress(progress);\r\n            },\r\n            (error) => {\r\n                console.log(error);\r\n                alert(error.message);\r\n            },\r\n            () => {\r\n                storage\r\n                    .ref(\"images\")\r\n                    .child(image.name)\r\n                    .getDownloadURL()\r\n                    .then(url => {\r\n                        db.collection(\"posts\").add({\r\n                            timestamp: firebase.firestore.FieldValue.serverTimestamp(),\r\n                            caption: caption,\r\n                            imageUrl: url,\r\n                            username: username\r\n                        });\r\n\r\n                        setProgress(0);\r\n                        setCaption(\"\")\r\n                        setImage(null);\r\n\r\n                    })\r\n            }\r\n        )\r\n    }\r\n\r\n\r\n    return (\r\n        <div className='imageUpload'>\r\n            <progress value={progress} max=\"100\"/>\r\n            <input type=\"text\" placeholder='Enter a caption..' onChange={event => setCaption(event.target.value)} value={caption} />\r\n            <input type='file' onChange={handleChange} />\r\n            <Button onClick={handleUpload}>Upload</Button>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default ImageUpload"],"mappings":"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"},"metadata":{},"sourceType":"module"}